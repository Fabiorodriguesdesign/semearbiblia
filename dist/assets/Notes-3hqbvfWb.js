import{m as w,e as $,u as C,r as d,t as a,a as b,c as y,j as e,R as D,l as R,B}from"./index-bFsWClXM.js";const I=(n,x)=>{const u={date:new Date().toISOString().split("T")[0],book:x,chapter:"1",verseStart:"1",verseEnd:""};if(n){const g=n.references&&n.references.length>0?n.references:[u];return{id:0,planTitle:"",title:"",content:"",tags:"",createdAt:new Date().toISOString(),...n,references:g}}return{id:0,planTitle:"",title:"",references:[u],content:"",tags:"",createdAt:new Date().toISOString()}},E=({noteToEdit:n,onSave:x,onCancel:u,onDelete:g})=>{const{language:l}=C(),i=d.useMemo(()=>R("all_canon",l),[l]),[t,m]=d.useState(()=>I(n,i[0]));d.useEffect(()=>{const c={...t,references:t.references.map(o=>{const s=b(o.book,"pt")||b(o.book,"en")||b(o.book,"es");return{...o,book:s?y(s,l):o.book}})};m(c)},[l,n]);const h=c=>{const{name:o,value:s}=c.target;m(r=>({...r,[o]:s}))},_=(c,o)=>{const{name:s,value:r}=o.target,j=[...t.references];j[c]={...j[c],[s]:r},m(k=>({...k,references:j}))},N=()=>{m(c=>({...c,references:[...c.references,{date:new Date().toISOString().split("T")[0],book:i[0],chapter:"1",verseStart:"1",verseEnd:""}]}))},f=c=>{if(t.references.length<=1)return;const o=t.references.filter((s,r)=>r!==c);m(s=>({...s,references:o}))},v=c=>{c.preventDefault(),x(t)};return e.jsxs("div",{className:"card",children:[e.jsx(B,{onClick:u,text:a.back[l]}),e.jsx("h2",{children:n&&n.id?a.notes_edit[l]:a.notes_new[l]}),e.jsxs("form",{onSubmit:v,className:"note-editor-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:a.notes_plan_title[l]}),e.jsx("input",{type:"text",name:"planTitle",value:t.planTitle,onChange:h,placeholder:a.notes_plan_title_placeholder[l]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:a.notes_note_title[l]}),e.jsx("input",{type:"text",name:"title",value:t.title,onChange:h,placeholder:a.notes_note_title_placeholder[l],required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:a.notes_references[l]}),e.jsx("div",{className:"references-list",children:t.references.map((c,o)=>e.jsxs("div",{className:"reference-item",children:[e.jsx("input",{type:"date",name:"date",value:c.date,onChange:s=>_(o,s),required:!0}),e.jsx("select",{name:"book",value:c.book,onChange:s=>_(o,s),children:i.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("input",{type:"number",name:"chapter",value:c.chapter,onChange:s=>_(o,s),placeholder:"Cap.",min:"1",required:!0}),e.jsx("input",{type:"number",name:"verseStart",value:c.verseStart,onChange:s=>_(o,s),placeholder:"InÃ­cio",min:"1",required:!0}),e.jsx("input",{type:"number",name:"verseEnd",value:c.verseEnd,onChange:s=>_(o,s),placeholder:"Fim",min:"1"}),e.jsx("button",{type:"button",className:"remove-reference-btn",onClick:()=>f(o),children:e.jsx("i",{className:"material-icons",children:"delete_outline"})})]},o))}),e.jsxs("button",{type:"button",className:"add-reference-btn",onClick:N,children:[e.jsx("i",{className:"material-icons",children:"add"})," ",a.notes_add_reading[l]]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:a.notes_content[l]}),e.jsx("textarea",{name:"content",rows:8,value:t.content,onChange:h,placeholder:a.notes_content_placeholder[l]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:a.notes_tags[l]}),e.jsx("input",{type:"text",name:"tags",value:t.tags,onChange:h,placeholder:a.notes_tags_placeholder[l]})]}),e.jsxs("div",{className:"note-editor-actions",children:[n&&n.id?e.jsxs("button",{type:"button",className:"delete-button",onClick:()=>g(n.id),children:[e.jsx("i",{className:"material-icons",style:{marginRight:"8px",fontSize:"1.2rem"},children:"delete"}),a.delete[l]]}):e.jsx("div",{}),e.jsxs("button",{type:"submit",className:"action-button",children:[e.jsx("i",{className:"material-icons",style:{marginRight:"8px",fontSize:"1.2rem"},children:"save"}),a.notes_save[l]]})]})]})]})},O=D.memo(({note:n,onEdit:x,onShare:u})=>{const{language:g}=C(),l=d.useCallback(i=>{i.stopPropagation(),u(n)},[n,u]);return e.jsxs("div",{className:"note-card",onClick:()=>x(n),role:"button",tabIndex:0,onKeyDown:i=>(i.key==="Enter"||i.key===" ")&&x(n),children:[n.planTitle&&e.jsx("p",{className:"note-card-plan-title",children:n.planTitle}),e.jsx("h3",{children:n.title}),e.jsxs("p",{className:"note-card-content",children:[n.content.substring(0,100),"..."]}),e.jsxs("div",{className:"note-card-footer",children:[e.jsx("span",{children:new Date(n.createdAt).toLocaleDateString()}),e.jsxs("div",{className:"note-card-footer-right",children:[n.tags&&e.jsx("span",{className:"note-card-tags",children:n.tags}),e.jsx("button",{className:"note-card-action-btn",onClick:l,"aria-label":a.share[g],children:e.jsx("i",{className:"material-icons",children:"share"})})]})]})]})}),T=()=>{const{notes:n,saveNote:x,deleteNote:u,noteInitialData:g,onNoteEditorOpened:l}=w(),{showToast:i}=$(),{language:t}=C(),[m,h]=d.useState(null);d.useEffect(()=>{g&&!m&&(h(g),l())},[g,m,l]);const _=d.useCallback(r=>h(r),[]),N=d.useCallback(()=>h({}),[]),f=d.useCallback(()=>h(null),[]),v=d.useCallback(r=>{const j=!r.id||r.id===0;x(r),h(null),i(j?a.note_created_toast[t]:a.note_updated_toast[t])},[x,i,t]),c=d.useCallback(r=>{window.confirm(a.confirm_delete[t])&&(u(r),h(null),i(a.note_deleted_toast[t]))},[u,i,t]),o=d.useCallback(async r=>{const j=a.appName[t],k=`
*${a.notes_share_text_title[t].replace("{appName}",j)}*

*${a.notes_share_text_note_title[t]}:* ${r.title}
*${a.notes_share_text_plan[t]}:* ${r.planTitle||a.notes_share_text_not_applicable[t]}

*${a.notes_share_text_references[t]}:*
${r.references.map(p=>{const S=b(p.book,"pt")||b(p.book,"en")||b(p.book,"es");return`- ${S?y(S,t):p.book} ${p.chapter}:${p.verseStart}${p.verseEnd?`-${p.verseEnd}`:""}`}).join(`
`)}

---
${r.content}
        `;try{await navigator.clipboard.writeText(k.trim()),i(a.copied_to_clipboard[t])}catch(p){i(a.copy_failed[t]),console.error("Failed to copy text: ",p)}},[t,i]),s=d.useMemo(()=>[...n].sort((r,j)=>new Date(j.createdAt).getTime()-new Date(r.createdAt).getTime()),[n]);return m?e.jsx(E,{noteToEdit:m,onSave:v,onCancel:f,onDelete:c}):e.jsxs("div",{className:"card",children:[e.jsx("h2",{children:a.notes_title[t]}),e.jsx("p",{children:a.notes_desc[t]}),e.jsx("div",{className:"notes-list",children:s.map(r=>e.jsx(O,{note:r,onEdit:_,onShare:o},r.id))}),e.jsx("button",{onClick:N,className:"fab","aria-label":a.notes_new[t],children:e.jsx("i",{className:"material-icons",children:"add"})})]})};export{T as default};
