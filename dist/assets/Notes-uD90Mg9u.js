import{m as y,c as w,u as k,r as d,t as n,a as _,h as S,j as e,R as $,i as D,B as R}from"./index-Bk6rtcjo.js";const B=(s,x)=>{const p={date:new Date().toISOString().split("T")[0],book:x,chapter:"1",verseStart:"1",verseEnd:""};if(s){const g=s.references&&s.references.length>0?s.references:[p];return{id:0,planTitle:"",title:"",content:"",tags:"",createdAt:new Date().toISOString(),...s,references:g}}return{id:0,planTitle:"",title:"",references:[p],content:"",tags:"",createdAt:new Date().toISOString()}},I=({noteToEdit:s,onSave:x,onCancel:p,onDelete:g})=>{const{language:l}=k(),o=d.useMemo(()=>D("all_canon",l),[l]),[a,u]=d.useState(()=>B(s,o[0]));d.useEffect(()=>{const r={...a,references:a.references.map(c=>{const t=_(c.book,"pt")||_(c.book,"en")||_(c.book,"es");return{...c,book:t?S(t,l):c.book}})};u(r)},[l,s]);const h=r=>{const{name:c,value:t}=r.target;u(m=>({...m,[c]:t}))},j=(r,c)=>{const{name:t,value:m}=c.target,b=[...a.references];b[r]={...b[r],[t]:m},u(i=>({...i,references:b}))},f=()=>{u(r=>({...r,references:[...r.references,{date:new Date().toISOString().split("T")[0],book:o[0],chapter:"1",verseStart:"1",verseEnd:""}]}))},N=r=>{if(a.references.length<=1)return;const c=a.references.filter((t,m)=>m!==r);u(t=>({...t,references:c}))},v=r=>{r.preventDefault(),x(a)};return e.jsxs("div",{className:"card",children:[e.jsx(R,{onClick:p,text:n.back[l]}),e.jsx("h2",{children:s&&s.id?n.notes_edit[l]:n.notes_new[l]}),e.jsxs("form",{onSubmit:v,className:"note-editor-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:n.notes_plan_title[l]}),e.jsx("input",{type:"text",name:"planTitle",value:a.planTitle,onChange:h,placeholder:n.notes_plan_title_placeholder[l]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:n.notes_note_title[l]}),e.jsx("input",{type:"text",name:"title",value:a.title,onChange:h,placeholder:n.notes_note_title_placeholder[l],required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:n.notes_references[l]}),e.jsx("div",{className:"references-list",children:a.references.map((r,c)=>e.jsxs("div",{className:"reference-item",children:[e.jsx("input",{type:"date",name:"date",value:r.date,onChange:t=>j(c,t),required:!0}),e.jsx("select",{name:"book",value:r.book,onChange:t=>j(c,t),children:o.map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("input",{type:"number",name:"chapter",value:r.chapter,onChange:t=>j(c,t),placeholder:"Cap.",min:"1",required:!0}),e.jsx("input",{type:"number",name:"verseStart",value:r.verseStart,onChange:t=>j(c,t),placeholder:"InÃ­cio",min:"1",required:!0}),e.jsx("input",{type:"number",name:"verseEnd",value:r.verseEnd,onChange:t=>j(c,t),placeholder:"Fim",min:"1"}),e.jsx("button",{type:"button",className:"remove-reference-btn",onClick:()=>N(c),children:e.jsx("i",{className:"material-icons",children:"delete_outline"})})]},c))}),e.jsxs("button",{type:"button",className:"add-reference-btn",onClick:f,children:[e.jsx("i",{className:"material-icons",children:"add"})," ",n.notes_add_reading[l]]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:n.notes_content[l]}),e.jsx("textarea",{name:"content",rows:8,value:a.content,onChange:h,placeholder:n.notes_content_placeholder[l]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:n.notes_tags[l]}),e.jsx("input",{type:"text",name:"tags",value:a.tags,onChange:h,placeholder:n.notes_tags_placeholder[l]})]}),e.jsxs("div",{className:"note-editor-actions",children:[s&&s.id?e.jsxs("button",{type:"button",className:"delete-button",onClick:()=>g(s.id),children:[e.jsx("i",{className:"material-icons",style:{marginRight:"8px",fontSize:"1.2rem"},children:"delete"}),n.delete[l]]}):e.jsx("div",{}),e.jsxs("button",{type:"submit",className:"action-button",children:[e.jsx("i",{className:"material-icons",style:{marginRight:"8px",fontSize:"1.2rem"},children:"save"}),n.notes_save[l]]})]})]})]})},E=$.memo(({note:s,onEdit:x,onShare:p})=>{const{language:g}=k(),l=d.useCallback(o=>{o.stopPropagation(),p(s)},[s,p]);return e.jsxs("div",{className:"note-card",onClick:()=>x(s),role:"button",tabIndex:0,onKeyDown:o=>(o.key==="Enter"||o.key===" ")&&x(s),children:[s.planTitle&&e.jsx("p",{className:"note-card-plan-title",children:s.planTitle}),e.jsx("h3",{children:s.title}),e.jsxs("p",{className:"note-card-content",children:[s.content.substring(0,100),"..."]}),e.jsxs("div",{className:"note-card-footer",children:[e.jsx("span",{children:new Date(s.createdAt).toLocaleDateString()}),e.jsxs("div",{className:"note-card-footer-right",children:[s.tags&&e.jsx("span",{className:"note-card-tags",children:s.tags}),e.jsx("button",{className:"note-card-action-btn",onClick:l,"aria-label":n.share[g],children:e.jsx("i",{className:"material-icons",children:"share"})})]})]})]})}),L=()=>{const{notes:s,saveNote:x,deleteNote:p,noteInitialData:g,onNoteEditorOpened:l}=y(),{showToast:o}=w(),{language:a}=k(),[u,h]=d.useState(null);d.useEffect(()=>{g&&!u&&(h(g),l())},[g,u,l]);const j=d.useCallback(t=>h(t),[]),f=d.useCallback(()=>h({}),[]),N=d.useCallback(()=>h(null),[]),v=d.useCallback(t=>{const m=!t.id||t.id===0;x(t),h(null),o(m?n.note_created_toast[a]:n.note_updated_toast[a])},[x,o,a]),r=d.useCallback(t=>{window.confirm(n.confirm_delete[a])&&(p(t),h(null),o(n.note_deleted_toast[a]))},[p,o,a]),c=d.useCallback(async t=>{const m=n.appName[a],b=`
*${n.notes_share_text_title[a].replace("{appName}",m)}*

*${n.notes_share_text_note_title[a]}:* ${t.title}
*${n.notes_share_text_plan[a]}:* ${t.planTitle||n.notes_share_text_not_applicable[a]}

*${n.notes_share_text_references[a]}:*
${t.references.map(i=>{const C=_(i.book,"pt")||_(i.book,"en")||_(i.book,"es");return`- ${C?S(C,a):i.book} ${i.chapter}:${i.verseStart}${i.verseEnd?`-${i.verseEnd}`:""}`}).join(`
`)}

---
${t.content}
        `;try{await navigator.clipboard.writeText(b.trim()),o(n.copied_to_clipboard[a])}catch(i){o(n.copy_failed[a]),console.error("Failed to copy text: ",i)}},[a,o]);return u?e.jsx(I,{noteToEdit:u,onSave:v,onCancel:N,onDelete:r}):e.jsxs("div",{className:"card",children:[e.jsx("h2",{children:n.notes_title[a]}),e.jsx("p",{children:n.notes_desc[a]}),e.jsx("div",{className:"notes-list",children:s.sort((t,m)=>new Date(m.createdAt).getTime()-new Date(t.createdAt).getTime()).map(t=>e.jsx(E,{note:t,onEdit:j,onShare:c},t.id))}),e.jsx("button",{onClick:f,className:"fab","aria-label":n.notes_new[a],children:e.jsx("i",{className:"material-icons",children:"add"})})]})};export{L as default};
