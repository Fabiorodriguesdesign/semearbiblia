import{r,u as j,c as _,t as a,j as e}from"./index-Bk6rtcjo.js";import{G as y}from"./index-XruELgxz.js";const C=()=>{const[c,o]=r.useState([]),[i,g]=r.useState(""),[l,d]=r.useState(!1),h=r.useRef(null),x=r.useRef(null),{language:s}=j(),{showToast:m}=_(),f=r.useMemo(()=>new y({apiKey:void 0}),[]),b=r.useCallback(()=>{h.current=f.chats.create({model:"gemini-2.5-flash",config:{systemInstruction:a.chat_system_instruction[s]}})},[f,s]);r.useEffect(()=>{b(),(async()=>{if(h.current){d(!0),o([]);try{const n=await h.current.sendMessage({message:a.chat_welcome_prompt[s]});o([{role:"model",text:n.text}])}catch(n){console.error("Error starting chat:",n),o([{role:"model",text:a.chat_error[s]}]),m(a.error_generic[s])}finally{d(!1)}}})()},[s,b,m]),r.useEffect(()=>{var t;(t=x.current)==null||t.scrollIntoView({behavior:"smooth"})},[c]);const v=r.useCallback(async t=>{if(t.preventDefault(),!i.trim()||l)return;const n={role:"user",text:i};if(o(u=>[...u,n]),g(""),d(!0),h.current)try{const u=await h.current.sendMessage({message:n.text});o(p=>[...p,{role:"model",text:u.text}])}catch(u){console.error("Error sending message:",u),o(p=>[...p,{role:"model",text:a.chat_error[s]}]),m(a.error_generic[s])}finally{d(!1)}},[i,l,s,m]);return e.jsxs("div",{className:"chat-view-container",children:[e.jsxs("div",{className:"chat-messages",children:[c.map((t,n)=>e.jsx("div",{className:`chat-message-wrapper ${t.role}`,children:e.jsxs("div",{className:`chat-bubble ${t.role}`,children:[t.role==="model"&&e.jsx("div",{className:"chat-bubble-header",children:a.nav_chat[s]}),e.jsxs("p",{children:[t.text,l&&t.role==="model"&&n===c.length-1&&e.jsx("span",{className:"typing-cursor"})]})]})},n)),l&&c.length>0&&c[c.length-1].role==="user"&&e.jsx("div",{className:"chat-message-wrapper model",children:e.jsxs("div",{className:"chat-bubble model",children:[e.jsx("div",{className:"chat-bubble-header",children:a.nav_chat[s]}),e.jsx("p",{children:e.jsx("span",{className:"typing-cursor"})})]})}),e.jsx("div",{ref:x})]}),e.jsxs("form",{className:"chat-input-form",onSubmit:v,children:[e.jsx("input",{type:"text",value:i,onChange:t=>g(t.target.value),placeholder:a.chat_input_placeholder[s].replace("{chatBotName}",a.nav_chat[s]),disabled:l}),e.jsx("button",{type:"submit",disabled:l||!i.trim(),"aria-label":a.send_message_aria[s],children:e.jsx("i",{className:"material-icons",children:"send"})})]})]})};export{C as default};
