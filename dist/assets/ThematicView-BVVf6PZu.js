import{r as o,h as B,e as R,u as j,t as h,c as w,a as C,j as e,k as T,B as D,R as v}from"./index-D_bUWnp8.js";import{t as E}from"./readingPlans-C_XEDzjy.js";import{p as I,R as S}from"./BibleDirectory-B6ygp-bj.js";const $=v.memo(({item:n,index:u,isExpanded:k,onToggle:b,onReferenceClick:c,onAddPlan:r})=>{const{language:l}=j(),m=o.useCallback(()=>{b(u)},[b,u]),a=o.useCallback(i=>{i.stopPropagation();const d={id:`theme_${n.theme.replace(/\s/g,"_").slice(0,25)}`,title:n.theme,description:`Estudo sobre "${n.theme}"`,data:{references:n.references}};r(d)},[n,r]);return e.jsxs("div",{className:"thematic-item",children:[e.jsxs("div",{className:"thematic-item-header-wrapper",children:[e.jsxs("button",{className:"thematic-item-header",onClick:m,"aria-expanded":k,children:[e.jsx("span",{children:n.theme}),e.jsx("i",{className:"material-icons",children:"expand_more"})]}),e.jsx("button",{className:"add-item-plan-btn",onClick:a,"aria-label":h.add_plan_for_aria[l].replace("{title}",n.theme),children:"+"})]}),e.jsx("div",{className:`thematic-item-references ${k?"expanded":""}`,children:n.references.map((i,d)=>e.jsx("button",{className:"thematic-reference-link",onClick:()=>c(i),children:i},d))})]})}),P=({onBack:n,onAddPlan:u})=>{const[k,b]=o.useState(null),[c,r]=o.useState(null),{getChapterContent:l}=B(),{showToast:m}=R(),{language:a}=j(),i=o.useCallback(async t=>{const s=I(t,a);if(!s){m(h.reference_not_found_toast[a].replace("{reference}",t));return}const{book:p,chapter:N}=s,g=parseInt(N,10),x=w(p,a),f=await l(p,g);if(!f){m(h.content_not_found_toast[a].replace("{book}",x).replace("{chapter}",String(g)));return}r({bookName:x,chapterNumber:g,chapterData:f})},[l,a,m]),d=o.useCallback(t=>{b(s=>s===t?null:t)},[]),_=o.useCallback(async t=>{if(!c)return;const{bookName:s}=c,p=C(s,a);if(!p)return;const N=await l(p,t);N&&(r({bookName:s,chapterNumber:t,chapterData:N}),window.scrollTo(0,0))},[c,l,a]);if(c){const t=C(c.bookName,a)||"";return e.jsx(S,{bookName:c.bookName,chapterNumber:c.chapterNumber,chapterData:c.chapterData,onBack:()=>r(null),totalChapters:T(t),onChapterChange:_})}return e.jsxs("div",{className:"card",children:[e.jsx(D,{onClick:n,text:h.back[a]}),e.jsx("h2",{children:h.thematic_title[a]}),e.jsx("p",{children:h.thematic_description[a]}),e.jsx("div",{className:"thematic-list",children:E.map((t,s)=>e.jsx($,{item:t,index:s,isExpanded:k===s,onToggle:d,onReferenceClick:i,onAddPlan:u},s))})]})};export{P as default};
