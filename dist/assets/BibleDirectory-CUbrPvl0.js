import{a as B,R as y,j as e,u as w,r as o,t as n,B as L,b as pe,c as F,d as K,e as W,f as ue,n as Q,h as J,i as z,k as ke,l as q}from"./index-Bk6rtcjo.js";import{g as be,d as U,a as xe,t as ge,b as je}from"./readingPlans-T_AOyLCJ.js";const ee=(a,s)=>{if(a.includes("toda a carta"))return null;const d=a.trim().toLowerCase().replace(/\s+/g," ").replace(/ a /g,"-").match(/^((\d\s)?[\wà-ú\s]+?)\.?\s(\d+)(?:[:.,](\d+(?:-\d+)?))?(?:,\s*(\d+))?$/);if(!d)return console.warn("Could not parse detailed reference:",a),null;const[,t,,l,h]=d,p=B(t.trim(),s);if(!p)return console.warn("Unknown book abbreviation in detailed reference:",t),null;let u="1",i="";if(h){const k=h.split("-");u=k[0],i=k[1]||""}return{book:p,chapter:l||"1",verseStart:u,verseEnd:i}},fe=y.memo(({book:a,onBookClick:s,onAddPlan:c})=>{const{language:d}=w(),t=o.useCallback(l=>{l.stopPropagation();const h=B(a,d);if(!h)return;const p=n.reading_plan_for_book_title[d].replace("{book}",a),u=n.reading_plan_for_book_desc[d].replace("{book}",a),i={id:`book_${h.replace(/\s/g,"_")}`,title:p,description:u};c(i)},[a,c,d]);return e.jsxs("div",{className:"book-card",children:[e.jsx("button",{className:"book-card-name",onClick:()=>s(a),children:a}),e.jsx("button",{className:"book-card-add-btn",onClick:t,"aria-label":n.add_plan_for_aria[d].replace("{title}",a),children:e.jsx("i",{className:"material-icons",children:"add"})})]})}),_e=y.memo(({books:a,onBookClick:s,onAddPlan:c})=>e.jsx("div",{className:"book-grid",children:a.map(d=>e.jsx(fe,{book:d,onBookClick:s,onAddPlan:c},d))})),Ne=y.memo(({verseData:a,bookName:s,chapterNumber:c})=>{const{addBookmark:d,removeBookmark:t,isBookmarked:l}=pe(),{showToast:h}=F(),{language:p}=w(),u=l(s,c,a.verse),i=o.useCallback(()=>{u?(t(s,c,a.verse),h(n.bookmark_removed[p])):(d({book:s,chapter:c,verse:a.verse,text:a.text}),h(n.bookmark_added[p]))},[u,s,c,a,d,t,h,p]);return e.jsxs("p",{className:"verse-item",id:`verse-${a.verse}`,children:[e.jsx("button",{className:`bookmark-btn ${u?"bookmarked":""}`,onClick:i,children:e.jsx("i",{className:"material-icons",children:u?"bookmark":"bookmark_border"})}),e.jsx("sup",{className:"verse-number",children:a.verse}),e.jsx("span",{className:"verse-text",children:a.text})]})}),Z=y.memo(({bookName:a,chapterNumber:s,chapterData:c,onBack:d,totalChapters:t,onChapterChange:l,verseToHighlight:h})=>{const{language:p}=w(),u=o.useRef(null),i=o.useRef(null);o.useEffect(()=>{h&&setTimeout(()=>{const m=document.getElementById(`verse-${h}`);m==null||m.scrollIntoView({behavior:"smooth",block:"center"})},100)},[h,a,s]);const k=o.useCallback(()=>{s>1&&l(s-1)},[s,l]),f=o.useCallback(()=>{s<t&&l(s+1)},[s,t,l]),_=o.useCallback(m=>{u.current=m.targetTouches[0].clientX,i.current=m.targetTouches[0].clientY},[]),b=o.useCallback(m=>{if(u.current===null||i.current===null)return;const x=m.changedTouches[0].clientX,g=m.changedTouches[0].clientY,T=x-u.current,r=g-i.current;Math.abs(T)>Math.abs(r)&&Math.abs(T)>50&&(T>0?k():f()),u.current=null,i.current=null},[k,f]);return e.jsxs("div",{className:"card reading-view",onTouchStart:_,onTouchEnd:b,children:[e.jsx(L,{onClick:d,text:n.back[p]}),e.jsxs("h2",{children:[a," ",s]}),e.jsx("div",{className:"verse-list",children:c.verses.map(m=>e.jsx(Ne,{verseData:m,bookName:a,chapterNumber:s},m.verse))}),e.jsxs("div",{className:"reading-nav",children:[e.jsxs("button",{className:"reading-nav-btn",onClick:k,disabled:s<=1,children:[e.jsx("i",{className:"material-icons",children:"chevron_left"}),e.jsx("span",{children:n.chapter_previous[p]})]}),e.jsxs("span",{className:"reading-nav-current",children:[a," ",s]}),e.jsxs("button",{className:"reading-nav-btn",onClick:f,disabled:s>=t,children:[e.jsx("span",{children:n.chapter_next[p]}),e.jsx("i",{className:"material-icons",children:"chevron_right"})]})]})]})}),Ce=y.memo(({chapterNum:a,onChapterSelect:s})=>e.jsx("button",{className:"chapter-item",onClick:()=>s(a),children:a})),ve=y.memo(({bookName:a,bookData:s,onChapterSelect:c,onBack:d})=>{const{language:t}=w();return e.jsxs("div",{className:"card",children:[e.jsx(L,{onClick:d,text:n.back_to_books[t]}),e.jsx("h2",{children:a}),e.jsx("p",{children:n.select_chapter_prompt[t]}),e.jsx("div",{className:"chapter-grid",children:Array.from({length:s.chapters.length},(l,h)=>h+1).map(l=>e.jsx(Ce,{chapterNum:l,onChapterSelect:c},l))})]})}),ae=y.memo(({title:a,description:s,bookSections:c,onBack:d,onAddPlan:t})=>{const[l,h]=o.useState(null),[p,u]=o.useState(null),[i,k]=o.useState(!1),[f,_]=o.useState(null),{showToast:b}=F(),{language:m}=w(),{getBookContent:x,version:g}=K(),T=o.useCallback(async N=>{if(!N)return;k(!0),_(null);const M=B(N,m);if(!M){b(n.content_not_available_toast[m].replace("{bookName}",N)),k(!1);return}const Y=await x(M,m,g);Y&&Y.chapters.length>0?(h(N),_(Y)):b(n.content_not_available_toast[m].replace("{bookName}",N)),k(!1)},[x,m,g,b]),r=o.useCallback(N=>u(N),[]),E=o.useCallback(N=>{u(N),window.scrollTo(0,0)},[]),X=o.useCallback(()=>u(null),[]),$=o.useCallback(()=>{h(null),u(null),_(null)},[]);if(i)return e.jsxs("div",{className:"card",children:[e.jsx("h2",{children:n.loading[m]}),e.jsx("p",{children:n.loading_book_content[m]})]});if(l&&p&&f){const N=f.chapters[p-1],M=B(l,m)||"";return e.jsx(Z,{bookName:l,chapterNumber:p,chapterData:N,onBack:X,totalChapters:W(M),onChapterChange:E})}return l&&f?e.jsx(ve,{bookName:l,bookData:f,onChapterSelect:r,onBack:$}):e.jsxs("div",{className:"card",children:[d&&e.jsx(L,{onClick:d,text:n.back[m]}),e.jsx("h2",{children:a}),e.jsx("p",{children:s}),c.map(N=>e.jsxs("div",{className:N.className||"",children:[e.jsx("h3",{className:"book-section-title",children:N.title}),e.jsx(_e,{books:N.books,onBookClick:T,onAddPlan:t})]},N.title))]})}),ye=y.memo(({onBack:a,onAddPlan:s})=>{const{language:c}=w(),d=o.useMemo(()=>[{title:n.old_testament[c],books:z("ot",c)},{title:n.deuterocanonical[c],books:z("dc",c),className:"deuterocanonical-section"},{title:n.new_testament[c],books:z("nt",c)}],[c]);return e.jsx(ae,{onBack:a,onAddPlan:s,title:n.bible_title[c],description:n.bible_description[c],bookSections:d})}),Be=y.memo(({onBack:a,onAddPlan:s})=>{const{language:c}=w(),d=o.useMemo(()=>[{title:n.selected_texts[c],books:z("ap",c)}],[c]);return e.jsx(ae,{onBack:a,onAddPlan:s,title:n.apocrypha_title[c],description:n.apocrypha_description[c],bookSections:d})}),we=y.memo(({onBack:a,onAddPlan:s})=>{const{language:c}=w(),d=o.useCallback(t=>{const l={id:`arch_${t.title.replace(/\s/g,"_").slice(0,20)}`,title:`Estudo: ${t.title}`,description:t.description};s(l)},[s]);return e.jsxs("div",{className:"card archaeology-container",children:[e.jsx(L,{onClick:a,text:n.back[c]}),e.jsx("h2",{children:n.archaeology_title[c]}),e.jsx("p",{children:n.archaeology_description[c]}),xe.map(t=>e.jsxs("div",{className:"archaeology-category",children:[e.jsx("h3",{className:"archaeology-category-title",children:t.category}),e.jsx("div",{className:"archaeology-items-grid",children:t.items.map(l=>e.jsxs("div",{className:"archaeology-item",children:[e.jsxs("div",{className:"archaeology-item-content",children:[e.jsx("h4",{className:"archaeology-item-title",children:l.title}),e.jsx("p",{className:"archaeology-item-description",children:l.description})]}),e.jsx("button",{className:"add-item-plan-btn",onClick:()=>d(l),"aria-label":n.add_plan_for_aria[c].replace("{title}",l.title),children:"+"})]},l.title))})]},t.category))]})}),Se=y.memo(({item:a,index:s,isExpanded:c,onToggle:d,onReferenceClick:t,onAddPlan:l})=>{const{language:h}=w(),p=o.useCallback(()=>{d(s)},[d,s]),u=o.useCallback(i=>{i.stopPropagation();const k={id:`theme_${a.theme.replace(/\s/g,"_").slice(0,25)}`,title:a.theme,description:`Estudo sobre "${a.theme}"`,data:{references:a.references}};l(k)},[a,l]);return e.jsxs("div",{className:"thematic-item",children:[e.jsxs("div",{className:"thematic-item-header-wrapper",children:[e.jsxs("button",{className:"thematic-item-header",onClick:p,"aria-expanded":c,children:[e.jsx("span",{children:a.theme}),e.jsx("i",{className:"material-icons",children:"expand_more"})]}),e.jsx("button",{className:"add-item-plan-btn",onClick:u,"aria-label":n.add_plan_for_aria[h].replace("{title}",a.theme),children:"+"})]}),e.jsx("div",{className:`thematic-item-references ${c?"expanded":""}`,children:a.references.map((i,k)=>e.jsx("button",{className:"thematic-reference-link",onClick:()=>t(i),children:i},k))})]})}),Te=y.memo(({onBack:a,onAddPlan:s})=>{const[c,d]=o.useState(null),[t,l]=o.useState(null),{getBookContent:h,version:p}=K(),{showToast:u}=F(),{language:i}=w(),k=o.useCallback(async b=>{const m=ee(b,i);if(!m){u(n.reference_not_found_toast[i].replace("{reference}",b));return}const{book:x,chapter:g}=m,T=parseInt(g,10),r=J(x,i),E=await h(x,i,p);if(!E||!E.chapters[T-1]){u(n.content_not_found_toast[i].replace("{book}",r).replace("{chapter}",String(T)));return}l({bookName:r,chapterNumber:T,chapterData:E.chapters[T-1]})},[h,i,p,u]),f=o.useCallback(b=>{d(m=>m===b?null:b)},[]),_=o.useCallback(async b=>{if(!t)return;const{bookName:m}=t,x=B(m,i);if(!x)return;const g=await h(x,i,p);g&&g.chapters[b-1]&&(l({bookName:m,chapterNumber:b,chapterData:g.chapters[b-1]}),window.scrollTo(0,0))},[t,h,i,p]);if(t){const b=B(t.bookName,i)||"";return e.jsx(Z,{bookName:t.bookName,chapterNumber:t.chapterNumber,chapterData:t.chapterData,onBack:()=>l(null),totalChapters:W(b),onChapterChange:_})}return e.jsxs("div",{className:"card",children:[e.jsx(L,{onClick:a,text:n.back[i]}),e.jsx("h2",{children:n.thematic_title[i]}),e.jsx("p",{children:n.thematic_description[i]}),e.jsx("div",{className:"thematic-list",children:ge.map((b,m)=>e.jsx(Se,{item:b,index:m,isExpanded:c===m,onToggle:f,onReferenceClick:k,onAddPlan:s},m))})]})}),De=y.memo(({gospel:a,passage:s,onPassageClick:c})=>{const{language:d}=w(),t=q(a,d),l=o.useCallback(()=>{s&&c(a,s)},[a,s,c]);return e.jsxs("div",{className:`passage-card gospel-${a}`,children:[e.jsx("div",{className:"passage-card__header",children:t}),e.jsx("div",{className:"passage-card__body",children:s?e.jsx("button",{className:"passage-card__link",onClick:l,children:s}):e.jsx("span",{className:"passage-card__empty",children:"-"})})]})}),Re=y.memo(({item:a,onPassageClick:s})=>{const{language:c}=w();return e.jsxs("section",{className:"harmony-event",children:[e.jsx("h3",{className:"harmony-event__title",children:a.evento}),e.jsx("div",{className:"harmony-event__passages",children:Object.entries(a.passagens).map(([d,t])=>e.jsx(De,{gospel:d,passage:t,onPassageClick:s},d))}),a.observacoes&&e.jsxs("div",{className:"harmony-event__notes",children:[e.jsxs("strong",{children:[n.harmony_notes[c],":"]})," ",a.observacoes]})]})}),Pe=y.memo(({onBack:a})=>{const[s,c]=o.useState(null),{getBookContent:d,version:t}=K(),{showToast:l}=F(),{language:h}=w(),p=o.useCallback(async(i,k)=>{if(!k)return;const f=q(i,"en"),_=q(i,h);if(!f)return;const m=k.replace(/\s*\(.*\)\s*/,"").trim().split(/[:\-]/)[0],x=parseInt(m,10);if(isNaN(x)){console.error("Could not parse chapter from passage:",k);return}const g=await d(f,h,t);if(!g||!g.chapters[x-1]){l(n.content_not_found_toast[h].replace("{book}",_).replace("{chapter}",String(x)));return}c({bookName:_,chapterNumber:x,chapterData:g.chapters[x-1]})},[d,h,t,l]),u=o.useCallback(async i=>{if(!s)return;const{bookName:k}=s,f=B(k,h);if(!f)return;const _=await d(f,h,t);_&&_.chapters[i-1]&&(c({bookName:k,chapterNumber:i,chapterData:_.chapters[i-1]}),window.scrollTo(0,0))},[s,d,h,t]);if(s){const i=B(s.bookName,h)||"";return e.jsx(Z,{bookName:s.bookName,chapterNumber:s.chapterNumber,chapterData:s.chapterData,onBack:()=>c(null),totalChapters:W(i),onChapterChange:u})}return e.jsxs("div",{className:"card",children:[e.jsx(L,{onClick:a,text:n.back[h]}),e.jsx("h2",{children:n.harmony_title[h]}),e.jsx("p",{children:n.harmony_description[h]}),e.jsx("div",{className:"harmony-list",children:je.map((i,k)=>e.jsx(Re,{item:i,onPassageClick:p},k))})]})}),Ae=y.memo(({results:a,query:s,onResultClick:c})=>{const d=(t,l)=>{if(!l)return t;const h=Q(l),p=Q(t).split(new RegExp(`(${h})`,"gi"));let u=0;return e.jsx(e.Fragment,{children:p.map((i,k)=>{const f=t.substring(u,u+i.length);return u+=i.length,Q(i).toLowerCase()===h.toLowerCase()?e.jsx("strong",{children:f},k):f})})};return e.jsx("div",{className:"search-results-container",children:a.map((t,l)=>e.jsxs("div",{className:"search-result-item",onClick:()=>c(t),role:"button",tabIndex:0,children:[e.jsxs("div",{className:"search-result-ref",children:[t.book," ",t.chapter,":",t.verse]}),e.jsx("p",{className:"search-result-text",children:d(t.text,s)})]},l))})}),Ve=({verseToNavigate:a,onVerseNavigated:s,initialQuery:c,onSearchHandled:d})=>{const{addPlan:t}=ue(),[l,h]=o.useState("index"),[p,u]=o.useState(""),[i,k]=o.useState([]),[f,_]=o.useState(!1),[b,m]=o.useState(null),{getBookContent:x,version:g,loading:T}=K(),{language:r}=w(),{showToast:E}=F(),X=o.useRef(new Map);o.useEffect(()=>{c&&d&&(u(c),d())},[c,d]),o.useEffect(()=>{(async()=>{if(a){const{book:C,chapter:v,verse:D}=a,I=B(C,"pt")||B(C,"en")||B(C,"es");if(!I)return;const A=J(I,r),S=await x(I,r,g);S&&S.chapters[v-1]&&m({bookName:A,chapterNumber:v,chapterData:S.chapters[v-1],verseToHighlight:D}),s()}})()},[a,s,x,r,g]);const $=o.useCallback(()=>h("index"),[]),N=o.useCallback(async j=>{const C=Q(j);if(!C)return[];const v=ee(j,r);if(v){const{book:A,chapter:S,verseStart:V}=v,P=parseInt(S,10),H=V?parseInt(V,10):null,G=J(A,r),O=await x(A,r,g);if(O&&O.chapters[P-1])return H&&O.chapters[P-1].verses[H-1]?[{book:G,chapter:P,verse:H,text:O.chapters[P-1].verses[H-1].text}]:[]}const D=[],I=z("all_canon",r);for(const A of I){const S=B(A,r);if(!S)continue;const V=await x(S,r,g);V&&V.chapters.forEach((P,H)=>{P.verses.forEach(G=>{Q(G.text).includes(C)&&D.push({book:A,chapter:H+1,verse:G.verse,text:G.text})})})}return D},[x,r,g]),M=o.useMemo(()=>ke(async j=>{const C=j.trim();if(!C){k([]),_(!1);return}if(X.current.has(C)){k(X.current.get(C)),_(!1);return}_(!0);const v=ee(C,r);if(v&&!v.verseStart){const{book:I,chapter:A}=v,S=parseInt(A,10),V=J(I,r),P=await x(I,r,g);if(P&&P.chapters[S-1]){E(`Navegando para ${V} ${S}...`),m({bookName:V,chapterNumber:S,chapterData:P.chapters[S-1]}),u(""),k([]),_(!1);return}}const D=await N(C);X.current.set(C,D),k(D),_(!1)},500),[x,r,g,N,E]);o.useEffect(()=>{M(p)},[p,M]);const Y=o.useCallback(async j=>{const C=B(j.book,r);if(!C)return;const v=await x(C,r,g);v&&v.chapters[j.chapter-1]&&m({bookName:j.book,chapterNumber:j.chapter,chapterData:v.chapters[j.chapter-1],verseToHighlight:j.verse})},[x,r,g]),se=o.useCallback(async j=>{if(!b)return;const{bookName:C}=b,v=B(C,r);if(!v)return;const D=await x(v,r,g);D&&D.chapters[j-1]&&(m({bookName:C,chapterNumber:j,chapterData:D.chapters[j-1]}),window.scrollTo(0,0))},[b,x,r,g]),te=o.useCallback(()=>h("bible"),[]),ne=o.useCallback(()=>h("gospelHarmony"),[]),ce=o.useCallback(()=>h("themes"),[]),oe=o.useCallback(()=>h("apocrypha"),[]),re=o.useCallback(()=>h("archaeology"),[]),R=o.useCallback(j=>{t(j)},[t]),le=o.useCallback(()=>R(be(r).find(j=>j.id==="anual_tradicional")),[R,r]),ie=o.useCallback(()=>R(U.gospelHarmony),[R]),de=o.useCallback(()=>R(U.themes),[R]),he=o.useCallback(()=>R(U.apocrypha),[R]),me=o.useCallback(()=>R(U.archaeology),[R]);if(T)return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"spinner-container",children:e.jsx("div",{className:"spinner"})}),e.jsx("p",{style:{textAlign:"center"},children:n.loading_bible[r]})]});if(b){const j=B(b.bookName,r)||"";return e.jsx(Z,{bookName:b.bookName,chapterNumber:b.chapterNumber,chapterData:b.chapterData,onBack:()=>m(null),totalChapters:W(j),onChapterChange:se,verseToHighlight:b.verseToHighlight})}return l==="bible"?e.jsx(ye,{onBack:$,onAddPlan:t}):l==="apocrypha"?e.jsx(Be,{onBack:$,onAddPlan:t}):l==="archaeology"?e.jsx(we,{onBack:$,onAddPlan:t}):l==="themes"?e.jsx(Te,{onBack:$,onAddPlan:t}):l==="gospelHarmony"?e.jsx(Pe,{onBack:$}):e.jsxs("div",{className:"card",children:[e.jsx("h2",{children:n.bible_directory_title[r]}),e.jsx("p",{children:n.bible_directory_desc[r]}),e.jsx("div",{className:"search-container",children:e.jsxs("div",{className:"search-input-wrapper",children:[e.jsx("i",{className:"material-icons",children:"search"}),e.jsx("input",{type:"text",className:"search-input",placeholder:n.bible_search_placeholder[r],value:p,onChange:j=>u(j.target.value),"aria-label":n.bible_search_placeholder[r]})]})}),f&&e.jsxs("div",{className:"search-loading",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:n.search_loading[r]})]}),!f&&p&&i.length>0&&e.jsx(Ae,{results:i,query:p,onResultClick:Y}),!f&&p&&i.length===0&&e.jsx("div",{className:"search-empty",children:e.jsxs("p",{children:[n.search_no_results[r],' "',p,'".']})}),!p&&e.jsxs("div",{className:"directory-grid",children:[e.jsxs("div",{className:"directory-item-wrapper",children:[e.jsx("button",{onClick:te,children:n.dir_read_bible[r]}),e.jsx("button",{className:"add-plan-from-dir-btn",onClick:le,"aria-label":n.add_plan_for_aria[r].replace("{title}",n.rp_anual_tradicional_title[r]),children:"+"})]}),e.jsxs("div",{className:"directory-item-wrapper",children:[e.jsx("button",{onClick:ne,children:n.dir_gospel_harmony[r]}),e.jsx("button",{className:"add-plan-from-dir-btn",onClick:ie,"aria-label":n.add_plan_for_aria[r].replace("{title}",n.dir_gospel_harmony[r]),children:"+"})]}),e.jsxs("div",{className:"directory-item-wrapper",children:[e.jsx("button",{onClick:ce,children:n.dir_thematic[r]}),e.jsx("button",{className:"add-plan-from-dir-btn",onClick:de,"aria-label":n.add_plan_for_aria[r].replace("{title}",n.dir_thematic[r]),children:"+"})]}),e.jsxs("div",{className:"directory-item-wrapper",children:[e.jsx("button",{onClick:oe,children:n.dir_apocrypha[r]}),e.jsx("button",{className:"add-plan-from-dir-btn",onClick:he,"aria-label":n.add_plan_for_aria[r].replace("{title}",n.dir_apocrypha[r]),children:"+"})]}),e.jsxs("div",{className:"directory-item-wrapper",children:[e.jsx("button",{onClick:re,children:n.dir_archaeology[r]}),e.jsx("button",{className:"add-plan-from-dir-btn",onClick:me,"aria-label":n.add_plan_for_aria[r].replace("{title}",n.dir_archaeology[r]),children:"+"})]})]})]})};export{Ve as default};
